SELECT STDASSESS.DESCRIPTION AS ASSESS_DESCRIPTION
	,AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID
	,AS_ASSESS_SCHEDULE_DETAILS.DETAIL_ID
	,AS_ASSESS_SCHEDULE_DETAILS.DUE_DATE
	,MPI.FIRST_NAME AS FIRST_NAME
	,AS_ASSESS_SCHEDULE_DETAILS.INCOMPLETE_DESC AS INCOMPLETE_DESCRIPTION
	,MPI.LAST_NAME AS LAST_NAME
	,SCHEDULE.SCHEDULE_DESCRIPTION
	,AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID
	,SCHEDULE.XXHOURS AS XX_HOURS
	,SCHEDULE.XXMINUTES AS XX_MINUTES
	,SCHEDULE.XXMONTHS AS XX_MONTHS
	,SCHEDULE.XXWEEKS AS XX_WEEKS
	,SCHEDULE.XXDAYS AS XX_DAYS
	,SCHEDULE.EVENT_ID AS EVENT_ID
	,SCHEDULE.SCHEDULE_TYPE AS SCHEDULE_TYPE
	,STDSCHEDULE.EVENT_TYPE AS EVENT_TYPE
	,SCHEDULE.TRIGGERED_BY_ASSESS_ID
FROM AS_ASSESS_SCHEDULE_DETAILS
LEFT JOIN CLIENTS CLIENTS ON AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID = CLIENTS.CLIENT_ID
LEFT JOIN AS_ASSESS_SCHEDULE SCHEDULE ON AS_ASSESS_SCHEDULE_DETAILS.SCHEDULE_ID = SCHEDULE.SCHEDULE_ID
	AND AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID = SCHEDULE.STD_ASSESS_ID
LEFT JOIN AS_STD_ASSESS_SCHEDULE STDSCHEDULE ON SCHEDULE.STD_SCHEDULE_ID = STDSCHEDULE.SCHEDULE_ID
	AND SCHEDULE.STD_ASSESS_ID = STDSCHEDULE.STD_ASSESS_ID
LEFT JOIN AS_STD_ASSESSMENT STDASSESS ON AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID = STDASSESS.STD_ASSESS_ID
LEFT JOIN MPI MPI ON CLIENTS.MPI_ID = MPI.MPI_ID
LEFT JOIN AS_ASSESSMENT ASSESS ON AS_ASSESS_SCHEDULE_DETAILS.ASSESS_ID = ASSESS.ASSESS_ID
	AND (ASSESS.DELETED = 'N')
WHERE (
		(
			AS_ASSESS_SCHEDULE_DETAILS.DUE_DATE < '2022-04-14 23:59:59'
			AND AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID IN (
				SELECT VALUE
				FROM PCC__CSVTOTABLEOFINT(
						'1,3,4,5,6,7,8,9,10,11,12,13,23,49,50,1050,1069,1070,1283,1284,10001,10003,10004,10007,10011,10028,10029,10031,10035,10039,10042,10044,10045,10047,10053,10058,10072,10077,10279,10282,10325,10329,10331,10332,10334,10337,10346,10356,10357,10359,10369,10400,10409,10410,10420,10421,10430,10439,10440,10449,10450,10459,10460,10469,10479,10489,10499,10509,10519,10529,10559,10569,10599,10609,10619,10629,10639,10649,10659,10669,10670,10679,10689,10709,10719,10749,10750,10770,10792,10804,10816,10826,10836,10846,10854,10870,10890,10916,10919,10920,10921,10922,10923,10924,10947,10955,10957,10961,10971,10972,10973,10974,10975,10979,10980,10981,10986,11064,11065,11069,11075,11175,11176,11183,11201,11202,11206,11234,11237,11238,11243,11246,11256,11275,11276,11289,11299,11314,11323,11341,11351,11361,11371,11381,11391,11433,11832,11834,11835,11836,11837,11838,11839,11840,11841,11842,11843,11844,11845,11846,11847,11848,11849,11850,11851,11852,11855,11857,11859,11860,11863,11864,11865,11866,11867,11868,11869,11871,11873,11874,11875,11876,11877,11878,11881,11882,11885,11889,11890,11891,11892,11893,11894,11895,11896,11898,11899,11900,11901,11902,11905,11907,11909,11910,11911,11912,11913,11915,11916,11917,11918,11919,11921,11924,11926,11927,11930,11931,11934,11935,11936,11937,11938,11939,11940,11943,11944,11946,11949,11951,11952,11953,11954,11955,11956,11957,11958,11961,11962,11963,11964,11965,11966,11967,11971,11972,11974,11976,11979,11981,11984,11985,11986,11987,11988,11989,11995,11996,11999,12005,12011,12012,12013,12014,12016,12024,12026,12027,12028,12029,12031,12033,12035,12041,12042,12043,12044,12046,12047,12048,12050,12051,12054,12057,12058,12060,12061,12062,12063,12065,12067,12073,12074,12075,12076,12077,12078,12079,12080,12081,12089,12090,12091,12092,12094,12095,12098,12099,12105,12107,12109,12110,12111,12114'
					)
				)
			AND AS_ASSESS_SCHEDULE_DETAILS.INCOMPLETE_DESC IS NULL
			AND STDASSESS.STATUS = 'A'
			AND CLIENTS.ADMISSION_DATE IS NOT NULL
			AND (
				AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID <> - 9999
				AND (
					DISCHARGE_DATE IS NULL
					OR DISCHARGE_DATE >= DUE_DATE
					)
				OR STDSCHEDULE.EVENT_TYPE = 'DC'
				)
			AND STDASSESS.IS_CLINICAL = 'Y'
			)
		)
	AND (
		(
			AS_ASSESS_SCHEDULE_DETAILS.FAC_ID = 2
			OR AS_ASSESS_SCHEDULE_DETAILS.FAC_ID = - 1
			)
		)
ORDER BY LAST_NAME
	,FIRST_NAME
	,DUE_DATE


	SELECT STDASSESS.DESCRIPTION AS ASSESS_DESCRIPTION
	,AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID
	,AS_ASSESS_SCHEDULE_DETAILS.DETAIL_ID
	,AS_ASSESS_SCHEDULE_DETAILS.DUE_DATE
	,MPI.FIRST_NAME AS FIRST_NAME
	,AS_ASSESS_SCHEDULE_DETAILS.INCOMPLETE_DESC AS INCOMPLETE_DESCRIPTION
	,MPI.LAST_NAME AS LAST_NAME
	,SCHEDULE.SCHEDULE_DESCRIPTION
	,AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID
	,SCHEDULE.XXHOURS AS XX_HOURS
	,SCHEDULE.XXMINUTES AS XX_MINUTES
	,SCHEDULE.XXMONTHS AS XX_MONTHS
	,SCHEDULE.XXWEEKS AS XX_WEEKS
	,SCHEDULE.XXDAYS AS XX_DAYS
	,SCHEDULE.EVENT_ID AS EVENT_ID
	,SCHEDULE.SCHEDULE_TYPE AS SCHEDULE_TYPE
	,STDSCHEDULE.EVENT_TYPE AS EVENT_TYPE
	,SCHEDULE.TRIGGERED_BY_ASSESS_ID
FROM AS_ASSESS_SCHEDULE_DETAILS
LEFT JOIN CLIENTS CLIENTS ON AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID = CLIENTS.CLIENT_ID
LEFT JOIN AS_ASSESS_SCHEDULE SCHEDULE ON AS_ASSESS_SCHEDULE_DETAILS.SCHEDULE_ID = SCHEDULE.SCHEDULE_ID
	AND AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID = SCHEDULE.STD_ASSESS_ID
LEFT JOIN AS_STD_ASSESS_SCHEDULE STDSCHEDULE ON SCHEDULE.STD_SCHEDULE_ID = STDSCHEDULE.SCHEDULE_ID
	AND SCHEDULE.STD_ASSESS_ID = STDSCHEDULE.STD_ASSESS_ID
LEFT JOIN AS_STD_ASSESSMENT STDASSESS ON AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID = STDASSESS.STD_ASSESS_ID
LEFT JOIN MPI MPI ON CLIENTS.MPI_ID = MPI.MPI_ID
LEFT JOIN AS_ASSESSMENT ASSESS ON AS_ASSESS_SCHEDULE_DETAILS.ASSESS_ID = ASSESS.ASSESS_ID
	AND (ASSESS.DELETED = 'N')
WHERE AS_ASSESS_SCHEDULE_DETAILS.client_id=234196
AND (
		(
			AS_ASSESS_SCHEDULE_DETAILS.DUE_DATE < '2022-04-14 23:59:59'
			AND AS_ASSESS_SCHEDULE_DETAILS.STD_ASSESS_ID IN (
				SELECT VALUE
				FROM PCC__CSVTOTABLEOFINT(
						'1,3,4,5,6,7,8,9,10,11,12,13,23,49,50,1050,1069,1070,1283,1284,10001,10003,10004,10007,10011,10028,10029,10031,10035,10039,10042,10044,10045,10047,10053,10058,10072,10077,10279,10282,10325,10329,10331,10332,10334,10337,10346,10356,10357,10359,10369,10400,10409,10410,10420,10421,10430,10439,10440,10449,10450,10459,10460,10469,10479,10489,10499,10509,10519,10529,10559,10569,10599,10609,10619,10629,10639,10649,10659,10669,10670,10679,10689,10709,10719,10749,10750,10770,10792,10804,10816,10826,10836,10846,10854,10870,10890,10916,10919,10920,10921,10922,10923,10924,10947,10955,10957,10961,10971,10972,10973,10974,10975,10979,10980,10981,10986,11064,11065,11069,11075,11175,11176,11183,11201,11202,11206,11234,11237,11238,11243,11246,11256,11275,11276,11289,11299,11314,11323,11341,11351,11361,11371,11381,11391,11433,11832,11834,11835,11836,11837,11838,11839,11840,11841,11842,11843,11844,11845,11846,11847,11848,11849,11850,11851,11852,11855,11857,11859,11860,11863,11864,11865,11866,11867,11868,11869,11871,11873,11874,11875,11876,11877,11878,11881,11882,11885,11889,11890,11891,11892,11893,11894,11895,11896,11898,11899,11900,11901,11902,11905,11907,11909,11910,11911,11912,11913,11915,11916,11917,11918,11919,11921,11924,11926,11927,11930,11931,11934,11935,11936,11937,11938,11939,11940,11943,11944,11946,11949,11951,11952,11953,11954,11955,11956,11957,11958,11961,11962,11963,11964,11965,11966,11967,11971,11972,11974,11976,11979,11981,11984,11985,11986,11987,11988,11989,11995,11996,11999,12005,12011,12012,12013,12014,12016,12024,12026,12027,12028,12029,12031,12033,12035,12041,12042,12043,12044,12046,12047,12048,12050,12051,12054,12057,12058,12060,12061,12062,12063,12065,12067,12073,12074,12075,12076,12077,12078,12079,12080,12081,12089,12090,12091,12092,12094,12095,12098,12099,12105,12107,12109,12110,12111,12114'
					)
				)
			AND 			AS_ASSESS_SCHEDULE_DETAILS.INCOMPLETE_DESC IS NULL
			AND STDASSESS.STATUS = 'A'
			AND CLIENTS.ADMISSION_DATE IS NOT NULL
			AND (
				AS_ASSESS_SCHEDULE_DETAILS.CLIENT_ID <> - 9999
				AND (
					DISCHARGE_DATE IS NULL
					OR DISCHARGE_DATE >= DUE_DATE
					)
				OR STDSCHEDULE.EVENT_TYPE = 'DC'
				)
			AND STDASSESS.IS_CLINICAL = 'Y'
			)
		)

	--SELECT std_assess_id FROM dbo.as_std_assessment_facility WHERE as_std_assessment_facility.fac_id = 2


	3028938-234196

	select * from EICase596184clients
	where src_id=3028938
	select * from INFORMATION_SCHEMA.TABLES
	where table_name like 'eicase%'

	select * from clients
	where client_id=234196

	select * from AS_ASSESS_SCHEDULE_DETAILS
	where client_id=234196
	and AS_ASSESS_SCHEDULE_DETAILS.DUE_DATE < '2022-04-14 23:59:59'
	and AS_ASSESS_SCHEDULE_DETAILS.INCOMPLETE_DESC IS NULL
			AND STDASSESS.STATUS = 'A'

			11220

			select * from as_std_assessment
			where std_assess_id=11220

			select b.status,c.status,c.* from EICase596184as_std_assessment a
			inner join [pccsql-use2-prod-ssv-tscon10.b4ea653240a9.database.windows.net].[test_usei963].dbo.as_std_assessment b on b.std_assess_id=a.src_id
			inner join as_std_assessment  c on c.std_assess_id=a.dst_id
			where 1=1
			and  b.status<>c.status
			src_id=516498


			update as_std_assessment
			set status='A'
			where std_assess_id=11220

			select * from as_std_assessment_facility
			where std_assess_id=11220

			insert into as_std_assessment_facility(fac_id,std_assess_id)
			select fac_id=2,std_assess_id from as_std_assessment
			where std_assess_id=11220



			select * from	 as_std_assessment
			where std_assess_id=11220

			select * from as_std_assessment_facility

			select * from as_std_assessment_system_assessment_mapping
				where std_assess_id=11220

				select * from as_std_assess_version_group
			
			select * from [pccsql-use2-prod-ssv-tscon10.b4ea653240a9.database.windows.net].[test_usei963].dbo.as_std_assessment
			where std_assess_id=516498


			select * from INFORMATION_SCHEMA.TABLES
			where table_name like '%as_std_assessment%'